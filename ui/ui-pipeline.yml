workflow:
  rules:
    - if: $CI_MERGE_REQUEST_ID

include:
  - ci/child-pipeline.yml

tests:
  stage: test
  extends: .cache_settings
  before_script:
    - cd $PIPELINE_ROOT
    - poetry install
  script:
    - poetry run pytest --cov --cov-report xml
    - poetry run coverage report
  cache:
    policy: pull
